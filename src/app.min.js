"use strict";let state;$(document).ready(function(){function t(t){let i=$(":focus").prop("tagName"),e=$(":focus").attr("tabindex"),s=$(":focus").siblings().length;"down"==t&&e<s&&(e++,$(i+"[tabindex="+e+"]").focus()),"up"==t&&e>0&&(e--,$(i+"[tabindex="+e+"]").focus()),"right"==t&&e<s&&(e++,$(i+"[tabindex="+e+"]").focus()),"left"==t&&e>0&&(e--,$(i+"[tabindex="+e+"]").focus())}function i(t){chat_feed.forEach(function(i,e){if(i.chatId==t){let t=moment(i.timestamp).format("DD.MM.YYYY, HH:MM");$("div#chat-messages").append('<div class="message '+i.direction+'"><div class="inner"><div class="text"><div>'+i.text+'</div><div class="date">'+t+"</div></div></div></div>")}})}function e(t){if("show"==t){$("div#chat-messages").empty(),i($(":focus").data("id")),$("div#chat-list").css("display","none"),$("div#chat").css("display","block"),setTabindex("div#chat-messages","div.message"),items=$("div#chat-messages div.message");let t=items.length-1;$(items[t]).focus(),$("div#bottom-bar div#button-left").html('<img src="icons/arrow-left.svg"/>'),$("div#bottom-bar div#button-center").html(""),$("div#bottom-bar div#button-right").html('<img src="icons/envelope.svg"/>'),state="chat"}"hidde"==t&&$("div#chat").css("display","none")}function s(t){if("show"==t){$("div#chat-list").empty();for(let t=0;t<data_chat_list.length;t++){let i='<li class="user-name flex">'+data_chat_list[t].name+'</li><li class="unread-messages">'+data_chat_list[t].unreadMessageCount+"</li>";$("div#chat-list").append('<ul class="user-item flex justify-content-spacebetween" data-id="'+data_chat_list[t].chatId+'"  >'+i+"</ul>")}$("div#chat-list").css("display","block"),setTabindex("div#chat-list","ul.user-item"),items=$("div#chat-list ul.user-item"),$(items[0]).focus(),$("div#bottom-bar div#button-left").html(""),$("div#bottom-bar div#button-center").text("select"),$("div#bottom-bar div#button-right").html(""),state="chat-list"}"hidde"==t&&$("div#chat-list").css("display","none")}function a(t){if("show"==t){$("div#chat div#chat-attachments").css("display","block"),$("div#chat div#chat-attachments div.inner div:first-child").focus(),$("div#bottom-bar div#button-left").html('<img src="icons/arrow-left.svg"/>'),$("div#bottom-bar div#button-center").html(""),$("div#bottom-bar div#button-right").html(""),setTabindex("div#chat-attachments div.inner","div"),items=$("div#chat-attachments div.inner div");let t=items.length-1;$(items[t]).focus(),state="attachment"}"hidde"==t&&($("div#chat div#chat-attachments").css("display","none"),$("div#chat div#chat-input textarea").focus(),$("div#chat div#bottom-bar div#button-left").html('<img src="icons/arrow-left.svg"/>'),$("div#chat div#bottom-bar div#button-center").html('<img src="icons/paperclip.svg"/>'),$("div#chat div#bottom-bar div#button-right").html('<img src="icons/envelope.svg"/>'),state="chat-input")}function c(t){"show"==t&&($("div#chat div#chat-input").css("display","block"),$("div#chat div#chat-input textarea").focus(),$("div#bottom-bar div#button-left").html('<img src="icons/arrow-left.svg"/>'),$("div#bottom-bar div#button-center").html('<img src="icons/paperclip.svg"/>'),$("div#bottom-bar div#button-right").html('<img src="icons/envelope.svg"/>'),state="chat-input"),"hidde"==t&&($("div#chat div#chat-input").css("display","none"),$("div#bottom-bar div#button-left").html('<img src="icons/arrow-left.svg"/>'),$("div#bottom-bar div#button-center").html(""),$("div#bottom-bar div#button-right").html('<img src="icons/edit.svg"/>'),state="chat")}function d(){clearTimeout(h)}function o(i){switch(i.key){case"Enter":if(h=setTimeout(d,1500),"chat-list"==state)return e("show"),!1;if("chat-input"==state)return i.preventDefault(),c("hidde"),a("show"),!1;break;case"ArrowDown":t("down");break;case"ArrowUp":t("up");break;case"ArrowLeft":t("left");break;case"ArrowRight":t("right");break;case"1":case"SoftLeft":if("chat"==state)return s("show"),e("hidde"),!1;if("chat-input"==state)return c("hidde"),e("show"),!1;if("attachment"==state)return a("hidde"),c("show"),!1;break;case"2":case"SoftRight":if(state="chat-input")return c("show"),!1;break;case"Backspace":i.preventDefault(),(state="chat-list")&&window.close()}}function n(t){switch(t.key){case"Enter":clearTimeout(h)}}let h;setTimeout(function(){state="chat-list",s("show"),$("div#intro").css("display","none")},2e3),document.addEventListener("keydown",o),document.addEventListener("keyup",n)});